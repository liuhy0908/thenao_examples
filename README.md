Start error free code first

Then implement it on array of tasks with a single task. See what happens to accuracy.

If accuracy increases, add different tasks

If it doesn't try debugging

It's really really easy. Just define variables and keep doing stuff with them. Finally calculate the resulstant.

Derivative happens automatically

Scan should take case of the batch_matmul hack

Problem Breakdown:

Also try word embedding from scratch. If that works you know word embedding.
If word embedding is not working, problem found
Otherwise debug rest of the code.
Remove the stupid batch_matmul and replace that with Scan
Check that it works with a batch. Since code is similar, results on a task should be the same.
Keep calculating everything at each step for forward pass

Start practicing test driven development?
